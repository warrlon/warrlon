# 消息队列MQ

#### 1.多个应用同时生成token，除了et参数之外，其他参数都一样，生成的多个token是否可以同时使用的？会不会使用了一个token，其他的token就会失效？

可以同时使用。MQ支持集群消息，所以这问题肯定会都支持的。

#### 2.消息列队的MQ_ID在哪里查看？

就是MQ的实例名称。

#### 3.消息队列MQ可以从服务端往设备端发送数据吗？

服务端调用API发，通过MQ不行。

#### 4.消费模式有至少一次、最多一次，支持精确一次吗？

当前不支持精确一次的消费模式，只支持到最多一次和最少一次。消息队列实现精确一次是很难的，代价不小，主流的mq都只支持到最少一次服务等级，精确一次场景需求并不多，一般消费者可以通过自己去重（如幂等）来解决重复消息。

#### 5.消息堆积超过了缓存限制会怎么办？

超过缓存限制的话，最旧的消息会被覆盖掉，一般是按照64MB按块回收一次，然后再次达到上限，又会触发新的按块回收。

#### 6.一般最多一次的消费模式在哪种情况下会丢消息？至少一次消费是怎么保证消息不丢的？

不管是最多一次还是至少一次消费模式，消费客户端连接到OneNET订阅后，OneNET publish推送给客户端的数据均为MQTT协议上的qos1。
正常情况下，客户端如果一直不回复的情况下，推送了256条消息后，就不会再推送后面的消息了，仅仅是在订阅时一次session失效可能会出现消息丢弃。
比如消费端连接断开，导致订阅session失效，这个时候那一瞬间即将推送的消息就会被丢弃。
