
# NB-IoT常见问题-注册相关
	
[本页目录]()

[1.终端无法和OneNET建立连接？](#1)

[2.SDK初始化模组失败？](#2)

[3.设备无法连接到平台，返回 4.03？](#3)

[4.关于平台自动订阅和手动订阅的使用？（设备级）](#4)

[5.设备如何判断订阅是否成功？](#5)

[6.关于平台自动发现和手动发现的使用？](#6)

[7.在哪些情况下平台会删除订阅？](#7)

<h3><table><tr><td bgcolor=#F2F2F2>模组相关问题</td></tr></table></h3>

<h4 id="1">1. 终端无法和OneNET建立连接？</h4>

答：请先确认终端是否正常附着到NB网络中，若网络附着正常，再检查终端连接报文和鉴权码是否正常，若两者皆正常工作，可通过4001-100-868转3咨询平台技术人员。

<h4 id="2">2. SDK初始化模组失败？</h4>

答：SDK在启动的时候会首先对当前模组的工作模式进行配置，使其能够附着进NB网络中，配置的方式是通过一系列AT指令。需要注意的是模组处理每条AT指令都需要一定的时间，因此建议AT指令间可以延迟几秒，否则会造成初始化过程失败。

<h3><table><tr><td bgcolor=#F2F2F2>鉴权失败</td></tr></table></h3>
<h4 id="3">3. 设备无法连接到平台，返回 4.03？</h4>

答：4.03 Forbidden 即接入机鉴权失败，接入机侧对设备鉴权规则如下：
* 如果设备没有设置Authcode则根据ep进行鉴权，ep不正确导致鉴权失败；
* 如果设备设置了Authodcode则通过ep+ Authcode 进行鉴权,ep和Authcode不正确或没有Authcode参数都会导致鉴权失败；
* 平台设置IP黑名单中的用户也会导致鉴权失败。

> 备注: Endpoint-Name（格式是 imei;imsi中间为分号），以上简称ep

<h3><table><tr><td bgcolor=#F2F2F2>订阅(Observer)和发现(Discover)</td></tr></table></h3>

<h4 id="4">4. 关于平台自动订阅和手动订阅的使用？（设备级）</h4>

答：自动订阅和手动订阅的使用如下：
* 自动订阅：当设备上线后，平台会主动向设备下发订阅命令。
* 手动订阅：设备上线后，需要手动下发订阅，且该次命令的有效期为一次上线期间，下次上线需要再次订阅。

> 备注：设备只有在订阅后才能上报数据。

<h4 id="5">5. 设备如何判断订阅是否成功？</h4>

答：平台会在全部订阅完成后，发送read 3/0操作，如果设备收到该read命令，则视为全部订阅成功。

<h4 id="6">6. 关于平台自动发现和手动发现的使用？</h4> 

答：发现资源可以查看到具体的资源列表。由于终端资源列表一般变化的可能性不大，出于低功耗考虑，平台对新建的产品默认取消自动发现功能，使得不必每次注册都下发Discover命令。如果用户想在平台看到实时的资源列表，可手动进行下发。

> 备注：开启/关闭自动发现可在产品级设置，手动下发discover则是对应Object下具体的一个Instance

<h4 id="7">7. 在哪些情况下平台会删除订阅？</h4>

答：注册和离线时会删除。

如果 Update 报文中删除了资源，平台也会移除订阅，删除到Instance。如果用户通过平台订阅到了某个Resource下面，设备注册和离线时会单独删除到对应的Resource下面。

