# 对话流的要素介绍

### 1. 意图

用于描述识别用户说出什么样子的话术会进入到该意图当中去。一个完整的意图包括用户的说法和语义槽参数。

![pic](/images/svs/意图.png)

自定义用户可能的说法，支持正则表达，按回车或者点击“添加”进行添加。用户说法只支持中英用户在对话交互过程中，可能会使用到丰富多样的句式发起命令或提问，开发者需要尽可能地完善用户说法。

以导航技能为例，用户可能会用到以下句式：

「导航到解放碑」

「从解放碑到洪崖洞怎么走」

将上述语料中提取出的关键字替换为语义槽后，可以得到以下说法：

「导航去#目的地# 」

「从#始发地#到#目的地#怎么走」

替换中使用到的“#”号为语义槽引用符号，必须成对出现，中间填写语义槽名称。

<table>
<tr><th width="10%">元素</th><th width="40%">说明</th><th>例子</th></tr>
<tr><td>$.</td><td>代表槽位（意图所需参数）表示方式$.参数名</td><td>$.城市<br>其中 城市 是用户定义的参数名</td></tr>
<tr><td>[]</td><td>代表可选符</td><td>[帮我|请帮我|麻烦帮我]取快递<br>代表可以是“取快递”、“帮我取快递”、“请帮我取快递”、“麻烦帮我取快递”<br>[]中的内容可有可无</td></tr>
<tr><td>()</td><td>必选符</td><td>周围的(烧烤\|火锅店)<br>代表可以是“周围的烧烤”、“周围的火锅店”，<br>但不可以是“周围的”</td></tr>
</table>


***说法标注***

标注是把句子中的说法标记为计算机可以理解的分类。例如把“查看重庆天气”里的重庆标注为城市，则计算机就可以理解重庆属于城市分类，当用户使用“查看XX（城市名称）天气”时，计算机均可理解句式。

标注当前分为自动标注和手动标注两种方式，在标注词库前必须先创建语义槽并选择对应的词库，自动标注可以把说法中的关键词通过已有词库进行标注，手动标注则是用“#”标注，必须成对出现。语义槽带有“sys.”标识的系统内置的词库。

除将语义槽直接写入说法的形式之外，对话服务平台也支持添加例句，通过对例句进行说法标注、将语义槽绑定词库的形式来完善用户说法。

### 2. 词库

词条是同类型单词的合集，如：城市、日期、颜色等。系统通过词库进行理解，然后抽取并输出机器可以理解的格式。例如用户说「我喜欢绿色」，我们都知道绿色是一种颜色，但如果我们不预先告诉机器，机器是不会知道的。为了让机器能够理解绿色，我们可以创建一个词条，把常见的颜色列举，这样机器再遇到这些词，就能知道是一种颜色。

**2.1 新建标准名词**

在生活和业务当中，有很多不同的词语代表着同一种意思，例如：上海、魔都、中国金融中心。这几个词语都是指同一个城市，那么我们可以通过配置的方式将这些词语指定到一个固定的专有名词下面。

![pic](/images/svs/新建标准名词.png)

**2.2 系统名词**

为了方便编辑对话流，预置了很多系统词库供您直接使用。

### 3. 触发节点

对话流的关键触发节点，当满足该节点包含的条件时，才能顺利的触发该节点对应的对话流。

**3.1 AND条件**

当配置意图时，第一项选择类型为意图，条件只能选 is，默认。值可以下拉列表快速搜索并选择该对话里的所有意图，如果没有可直接新建。

当配置词库时，第一项选择类型词库，条件可以选is、is not null、is null等等。范围可以选该对话里的所有词库词条，如果没有可直接新建，值可以填写任意。

当配置全局变量时，第一项选择类型为全局变量，第二项选择选择该对话里的所有全局变量，如果没有可直接新建，条件可以选is、is not、>、<等等，值可以填写任意。

**3.2 OR 条件**

OR之间是不同的条件组，满足任意一个条件组，即可满足条件生命周期。当条件中存在意图时，也就是整个对话系统在等待用户说出某一句话，然后判断是否满足条件，这种情况下，往往存在意图被其他对话打断的情况，生命周期的轮数，就是最多允许用户打断几轮，如果在最大限制之内，用户可以随时接着聊该对话的话题，整个对话将会自动恢复。

### 4. 填槽节点

如果用户触发意图的句子缺失槽位，填槽节点将会逐个进行反问，直到收集齐为止。

### 5. 函数节点

支持HTTP/HTTPS协议，填入API地址点击“测试”可以获取接口的参数名称。

例如：POST/GET方法，query/header/body的请求体。

如果想在配置对变量进行引用，针对不同的变量类型有不同的引用方式：

**5.1 槽值引用**

原始值引用：${ slot.意图名.槽位名.origin }

归一值引用：${ slot.意图名.槽位名}

**5.2 全局变量**

${global.全局变量名}

**5.3 外部传入的环境变量**

${ function.函数节点名.函数返回参数}

### 6. 回复节点

该节点用于编辑回复用户的信息模板，可以使用“$”引用语义槽参数。


