# 开发流程

测试接入流程分为平台域和设备域，用于帮助您进行首次接入体验，以便对平台的功能以及接入协议有大致的了解。

测试流程图如下：

![pic](/images/Modbus/测试流程.png)

**接入步骤**如下：

**Step1创建产品，选择接入协议**

首先您需要在平台创建一个**接入协议为MODBUS**的产品

**Step2 创建设备创建设备，记录设备ID等信息**

通过页面点击**添加设备**，输入**设备名称**和**鉴权信息**（即设备编号），并记录下该设备编号.

**Step3 创建数据流**

添加采样数据流，一个采样数据流对应着一条周期性采集命令
![pic](/images/Modbus/添加采样数据流.png)

配置相关采样信息，点击**保存**
![pic](/images/Modbus/保存数据流配置.png)


**Step4 建立设备连接**

以产品ID和建立设备时输入的号码、密码为参数，按以下顺序序列化报文，发送至平台，建立设备连接

| 字段 | 长度/byte | 说明 |
|:---|---|---|---|---|
| type | 11 | 设备类型，以'/0'结尾，目前保留 |
| name | 9 | 设备名称，以'/0'结尾，目前保留 |
| phone | 12 | DTU手机号，以'/0'结尾，用于设备登录鉴权 |
| svrpwd | 9 | DTU密码，以'/0'结尾，用于设备登录鉴权 |
| id | 11 | 产品ID，以'/0'结尾，平台申请项目时分配的产品ID |

设备连接建立之后，将看到设备在线状态（如下图），同时平台将会按照设定的**数据周期**的下发该采集命令
![pic](/images/MQTT/在线.png)

**Step6 保持设备在线**

当设备处于空闲的时候，为了保持与OneNET平台的连接不断开，需要定期发送**心跳包**（**0x0000**），以确保TCP连接不断开。其中时间间隔须**小于5分钟**，推荐1～3分钟。