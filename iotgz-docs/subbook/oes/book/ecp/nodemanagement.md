# 边缘节点管理

边缘节点是您自己的边缘计算设备，用于运行边缘应用，处理您的数据，并安全、便捷地和云端应用进行协同。您可以通过边缘计算管理平台部署系统应用来延伸云服务能力到边缘节点，或者通过部署您自己的应用来构建您自己的边缘计算能力。 

边缘节点管理：可以创建、删除、修改、查询边缘节点，支持对边缘节点关联/解除关联设备，管理子设备通信通道，管理边缘节点端的联动规则和数据路由等。

## 创建边缘节点产品

1.进入**边缘IoT管理**页面后，在左侧**设备管理**栏选择**边缘节点管理**，进入边缘节点管理页，如图：

![](/images\oes\ecp\创建边缘节点2.png)

2.创建边缘节点产品：点击**添加边缘节点产品**可以创建新的边缘节点产品。

![](/images\oes\ecp\添加边缘节点产品.png)

​**查看边缘节点产品**：创建边缘节点产品后，可以查看产品下面的节点。

## 创建边缘节点

1.在产品详情页面，点击**添加边缘节点**：

![](/images\oes\ecp\添加边缘节点.png)

边缘IoT管理支持AMD 64，ARM 64，ARM三种不同CPU架构。

2.添加完毕后如下：

![](/images\oes\ecp\节点产品列表.png)

​支持对边缘节点进行**启用/禁用/编辑/删除/查看详情**等操作。

​**查看边缘节点详情**：点击列表操作列对应的**详情**按钮，可以查看边缘节点的详情信息，如图：

![](/images\oes\ecp\边缘节点详情.png)

## 边缘节点配置

1.点击上面Tab页**边缘节点配置**可进入边缘节点配置页面，配置页面如图：

![](/images\oes\ecp\边缘节点配置.png)

i. **子设备管理**：可以分别查看/关联/移除MQTT协议、Modbus协议、OPC-UA协议的子设备信息，支持批量操作，支持查看拓扑图。

ii. **子设备通道管理**：可以对Modbus和OPC-UA协议的子设备的通道进行创建/设置/分配。

![](/images\oes\ecp\Modbus通道.png)

Modbus通道中，部分字段释义如下：

| 名称     | 描述                                                         |
| -------- | ------------------------------------------------------------ |
| 通道名字 | Modbus通道的名称，用户可自定义                               |
| 通道协议 | Modbus                                                       |
| 传输模式 | RTU                                                          |
| 选择串口 | 设备连接到边缘节点的串口，不同节点操作系统下可选择不同的值，例如/dev/ttyUSB0 |
| 波特率   | 衡量串口通信中实际数据位的参数                               |
| 数据位   | 衡量串口通信中实际数据位的参数                               |
| 校验位   | 一种简单的校错方式，判断是否有噪声干扰通信或者是否存在传输和接收数据不同步 |
| 停止位   | 用于表示单个数据包的最后一位                                 |

![](/images\oes\ecp\OPCUA通道.png)

OPC-UA通道中，部分字段释义如下:

| 名称             | 描述                                      |
| ---------------- | ----------------------------------------- |
| 通道名称         | OPC-UA通道的名称，用户可自定义            |
| 通道协议         | OPC-UA                                    |
| 通道地址         | OPC-UA Server的地址，必须为opc.tcp://开头 |
| 用户名           | OPC-UA Server授权的用户名                 |
| 密码             | OPC-UA Server授权的密码                   |
| 方法调用超时时间 | 调用Server方法超时时间                    |

iii. **场景联动**：支持把规则引擎下发至边缘节点，让边缘节点也具有规则引擎功能。详见边缘计算AEP。

iv. **云边消息**：支持把数据路由功能下发至边缘节点，让边缘节点也具有数据路由的功能。

```
说明：创建云边消息时，选择边缘端执行的客户端（路由实例）才可以再此分配。
```

​		①点击分配客户端：

![](/images\oes\ecp\点击分配客户端.png)

​		②选择客户端：

![](/images\oes\ecp\选择客户端.png)

​		③完成分配：

![](/images\oes\ecp\完成客户端分配.png)

v. **运行日志**：可以查看边缘的运行日志。

vi. **基础配置**：可以查看边缘节点的基础配置，比如配置中断续传的支持的最大时间。

![](/images\oes\ecp\基础配置.png)

​		中断续传：边缘节点断网后，把数据保存在节点本地，待网络恢复后，再继续上传。

vii. **部署日志**：可以查看边缘节点的部署日志。

viii. **部署配置**：在设置页面的所有设置都必须点击**部署配置**后，才会把设置同步至边缘节点。如配置有修改但是未部署时，会提示有修改未部署。

![](/images\oes\ecp\部署配置.png)

## 安装边缘节点软件栈

在节点详情页面点击**安装边缘节点软件栈**，会弹出安装命令，如下：

![](/images\oes\ecp\安装边缘节点软件栈.png)

```
Step 1.请在安装节点软件之前先安装docker，可通过以下命令安装 docker 的最新版本（适用于 Linux 系统）（或者参考docker官网安装最新版本。）
命令：curl -ssl https://get.docker.com | sh
```

```
Step 2. 复制以下命令在linux终端上执行安装
命令：wget --no-check-certificate https://www.onenetv3.com/oes/download/onenetedge-amd64.tar.gz && sudo tar -zxvf onenetedge-amd64.tar.gz && sudo ./onenetedge/onenetedge.sh install -i [边缘节点ID] -p [边缘节点产品ID] -k [边缘节点产品MasterKey] -r [MQTT接入能力地址] -d swr-cn.heclouds.com 
```

```
Step 3. 启动程序
如果支持systemd,执行命令：systemctl start onenetedge
如果不支持systemd,执行命令：/usr/local/onenetedge/onenetedge.sh start
```

把命令依次在边缘节点上执行即可完成边缘节点软件栈的安装，安装完成后可以通过查看docker进程判断节点软件栈是否安装成功。

```
说明：边缘节点对平台端应能网络可达。
```
此时边缘节点处于在线状态。