# 云边消息

边缘IoT管理提供了云边消息路由功能，您可以配置消息路由，边缘节点将根据消息路由将消息转发至对应端点，让消息按照规定的路径转发，灵活控制数据路由，并提高数据安全性。

- 消息端点：发送或接收消息的一方，可以是设备、云服务等，支持KAKFA、MQTT、MYSQL、REST方式转发。
- 消息路由：消息转发的路径。

## 路由实例介绍

进入**边缘IoT管理**控制台，在左侧**云边消息**栏选择**路由实例配置**，进入路由实例配置管理页。

路由实例，是指每个路由规则的实例。比如现在需要把一个MQTT设备的数据通过HTTP转发到某个地址。那么定义具体哪个设备，转发什么内容，转发至哪个目的地，数据格式是什么，这些信息的集合就是路由实例。目的地端点是什么，有无用户名密码（比如MYSQL、MQTT），地址端口是多少等叫目的地。如图：

![](/images\oes\ecp\ECP-路由实例主界面.png)

在此页面除了常用的搜索查看以外，支持**添加/删除/编辑**路由实例。

## 添加路由实例

通过规则引擎的数据流转功能，边缘IoT管理可将指定的设备数据转发至其他服务中。下面将为您详细讲解如何设置一条完整的数据转发规则。

1.登录**边缘IoT管理**控制台，在左侧导航栏中，选择**云边消息**>**路由目的地端点**，点击右上角**添加路由目的地端点**进行目的地配置。平台目前支持四种目的地类型配置，包括REST，MQTT，KAFKA，MYSQL。

i. REST(需输入目的地名称，地址，端口，访问路径)。

![](/images\oes\ecp\ECP-云边消息-添加路由目的地端点REST.png)

​ii. MQTT(需输入目的地名称，地址，端口，ClinetID，用户名，密码，Topic)：

![](/images\oes\ecp\ECP-云边消息-添加路由目的地端点MQTT.png)

​iii. KAFKA(需输入目的地名称，地址，端口，客户端标识，Topic)：

![](/images\oes\ecp\ECP-云边消息-添加路由目的地端点KAFKA.png)

​iv. MYSQL(需输入目的地名称，地址，端口，用户名，密码，数据库，表名)：

![](/images\oes\ecp\ECP-云边消息-添加路由目的地端点MYSQL.png)

2.在**路由实例**页签栏下，单击**添加路由实例**。

3.填写路由实例名称与相关参数，单击**确定**，完成路由实例添加。

   ![](/images\oes\ecp\路由实例相关参数.png)

**参数说明**

|     参数     | 描述                                                         |
| :----------: | ------------------------------------------------------------ |
| 路由实例名称 | 输入规则名称，用以区别各条规则。名称支持中文汉字、英文字母、数字、下划线和连字符。长度为 4-30 字节 |
|   执行任务   | 边缘端：此转发动作在边缘端执行                               |
|  客户端类型  | 支持标准模式类型                                             |
|   转发方式   | 目前支持 REST、MQTT、KAFKA 、MYSQL四种方式                   |
|  目的地名称  | 直接关联配置好的目的地名称                                   |
|   数据格式   | 目前支持 JSON、XML、SERIALIZED、CSV                          |
|   加密方式   | 选择是否用 AES 加密数据                                      |
|     密钥     | 如选择AES加密，需要填写加密密钥，128bit，16字节。例如3ADD0203010405060708090A0B0C0D |
|  初始化向量  | 如选择AES加密,才可以填写此项（*可选*），此向量为AES加密的初始化向量 |
|   压缩方式   | 可以选择 GZIP、ZIP 和无压缩                                  |
|   所属产品   | 选择当前用户下面需要转发的产品，可以添加多个产品             |
|   设备过滤   | 选择某个具体需要转发的设备或者该产品下的所有设备             |
|   属性过滤   | 选择要过滤的属性                                             |
